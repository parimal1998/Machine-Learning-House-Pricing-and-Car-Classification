"0","library(class)"
"0",""
"0","#Performing a loop to find out the best neighbours for KNN"
"0","k_values <- 1:45"
"0","accuracy_scores <- numeric(length(k_values))"
"0","for (i in k_values) {"
"0","  knn_pred <- knn(train = x_train, test = x_test, cl = y_train, k = i)"
"0","  accuracy_scores[i] <- mean(knn_pred == y_test)"
"0","}"
"0",""
"0","# Find best k"
"0","best_k <- which.max(accuracy_scores)"
"0","cat(""Best k ="", best_k, ""with Accuracy ="", round(accuracy_scores[best_k] * 100, 2), ""%\n"")"
"1","Best k ="
"1"," "
"1","2"
"1"," "
"1","with Accuracy ="
"1"," "
"1","93.98"
"1"," "
"1","%
"
"0","# Plotting accuracy vs. k"
"0","accuracy_df <- data.frame(k = k_values, Accuracy = accuracy_scores)"
"0","ggplot(accuracy_df, aes(x = k, y = Accuracy)) +"
"0","  geom_line(color = ""steelblue"", size = 1.2) +"
"0","  geom_point(color = ""darkred"", size = 2) +"
"0","  geom_vline(xintercept = best_k, linetype = ""dashed"", color = ""forestgreen"") +"
"0","  scale_y_continuous(labels = scales::percent_format()) +"
"0","  labs(title = ""KNN Accuracy vs. K"","
"0","       x = ""Number of Neighbors (k)"","
"0","       y = ""Accuracy"") +"
"0","  theme_minimal()"
